<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Pokemon Infinite Locator</title>
</head>

<body>

</body>
<script>
    async function fetchData() {

        let rawData = await fetch(`./fusion.txt`)
            
        rawData = await rawData.text();

        locBlocks = rawData.split(/##+\d*/)

        locations = [];

        locBlocks.forEach(loc => {
            if(loc === "") { return; }

            var locInfo = loc.split(/\n+/);

            if(locInfo[0] === "") {
                locInfo.shift();
            }

            if(locInfo[0] === "") { return; }

            let location = {};

            locName = locInfo[0].split('#');
            
            location.name = locName[1];
            location.id = locName[0].replace("Map ", "").trim();
            location.pokemon = {};

            let locationId = "";
            for(var i = 1; i<locInfo.length; i++) {
                var iLoc = locInfo[i];
                if((/Land|Water|OldRod|GoodRod|SuperRod|Cave|LandDay|LandNight|LandMorning|RockSmash/).test(iLoc)) {
                    locationId = iLoc.toLowerCase();
                    location.pokemon[locationId] = [];
                }else if ((/^(\d+,)+/).test(iLoc)) {
                    continue;
                } else {
                    location.pokemon[locationId].push(iLoc);
                }
            }
            
            locations.push(location);
        });
    }


    fetchData();
</script>

</html>